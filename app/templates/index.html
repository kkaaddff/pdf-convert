<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF 黑白转换服务</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>PDF 黑白转换服务</h1>
            <p>将彩色 PDF 转换为黑白/灰度版本，支持多档灰度级别选择</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section class="upload-section">
                <div class="upload-container" id="uploadContainer">
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">📄</div>
                        <h3>拖拽 PDF 文件到此处</h3>
                        <p>或者</p>
                        <button class="upload-button" id="uploadButton">选择文件</button>
                        <input type="file" id="fileInput" accept=".pdf" style="display: none;">
                        <p class="upload-hint">支持最大 50MB，最多 100 页的 PDF 文件</p>
                    </div>
                </div>

                <!-- Gray Level Selection -->
                <div class="settings-container" id="settingsContainer" style="display: none;">
                    <h3>转换设置</h3>
                    <div class="setting-item">
                        <label for="grayLevels">灰度档位：</label>
                        <select id="grayLevels" name="gray_levels">
                            <option value="1">1 档 - 纯黑白 (2 色阶)</option>
                            <option value="2" selected>2 档 - 黑白 + 50% 灰 (3 色阶)</option>
                            <option value="3">3 档 - 黑白 + 33%/66% 灰 (4 色阶)</option>
                            <option value="4">4 档 - 黑白 + 25%/50%/75% 灰 (5 色阶)</option>
                        </select>
                    </div>
                    <button class="convert-button" id="convertButton">开始转换</button>
                </div>
            </section>

            <!-- Progress Section -->
            <section class="progress-section" id="progressSection" style="display: none;">
                <h3>转换进度</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">准备中...</p>
            </section>

            <!-- Preview Section -->
            <section class="preview-section" id="previewSection" style="display: none;">
                <h3>转换结果预览</h3>

                <!-- Page Navigation -->
                <div class="page-navigation">
                    <button class="nav-button" id="prevPage" disabled>上一页</button>
                    <span class="page-info">
                        第 <span id="currentPage">1</span> 页，共 <span id="totalPages">1</span> 页
                    </span>
                    <button class="nav-button" id="nextPage" disabled>下一页</button>
                    <div class="zoom-controls">
                        <button class="zoom-button" id="zoomOut">-</button>
                        <span class="zoom-level" id="zoomLevel">100%</span>
                        <button class="zoom-button" id="zoomIn">+</button>
                    </div>
                </div>

                <!-- Comparison View -->
                <div class="comparison-container">
                    <div class="comparison-item">
                        <h4>原始文件</h4>
                        <div class="image-container">
                            <img id="originalImage" src="" alt="原始页面" loading="lazy">
                        </div>
                    </div>
                    <div class="comparison-item">
                        <h4>转换结果</h4>
                        <div class="image-container">
                            <img id="convertedImage" src="" alt="转换后页面" loading="lazy">
                        </div>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="download-section">
                    <button class="download-button" id="downloadButton" disabled>
                        下载转换后的 PDF
                    </button>
                    <button class="new-convert-button" id="newConvertButton">
                        转换新文件
                    </button>
                </div>
            </section>

            <!-- Error Message -->
            <section class="error-section" id="errorSection" style="display: none;">
                <div class="error-container">
                    <h3>❌ 转换失败</h3>
                    <p id="errorMessage">发生未知错误</p>
                    <button class="retry-button" id="retryButton">重试</button>
                </div>
            </section>
        </main>

        <footer>
            <p>PDF 黑白转换服务 v1.0.0 | 基于 Python 3.12 + FastAPI</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p>处理中...</p>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>